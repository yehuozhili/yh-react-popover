{"version":3,"sources":["components/minifymodal.tsx","components/index.tsx","components/position.tsx","components/hooks.tsx","App.tsx","serviceWorker.ts","index.tsx"],"names":["mount","document","body","Modal","props","constnode","visible","closeFuncCallback","innerDomStyle","innerConstDomStyle","state","setState","unmount","render","useMemo","createPortal","className","style","children","useEffect","display","onClick","Popover","content","directions","callback","constDomStyle","modalDomStyle","triangleDomStyle","modalRefCallback","needOutsideClose","useState","setVisible","setStyle","triaStyle","setTriaStyle","forceState","forceRender","modalRef","useRef","ref","v","constDom","finalRender","position","boxShadow","borderRadius","padding","background","zIndex","triangle","transform","height","width","borderColor","current","scroll","documentElement","scrollTop","res","sign","modalrect","popconfirmrect","top","left","console","error","switchPosition","getBoundingClientRect","res2","Math","sqrt","switchTrianglePosition","handler","prev","window","addEventListener","removeEventListener","parentSetState","delay","timer","setTimeout","clearTimeout","innerClose","useStateAnimation","listener","event","contains","target","defaultProps","App","justifyContent","alignItems","color","Boolean","location","hostname","match","ReactDOM","StrictMode","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch","message"],"mappings":"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","file":"static/js/main.5e61491e.chunk.js","sourcesContent":["import React, {\r\n\tCSSProperties,\r\n\tPropsWithChildren,\r\n\tReactNode,\r\n\tuseEffect,\r\n\tuseMemo,\r\n} from \"react\";\r\nimport { createPortal } from \"react-dom\";\r\n\r\ninterface ModalProps {\r\n\tconstnode: ReactNode;\r\n\tvisible: boolean;\r\n\tsetVisible: React.Dispatch<React.SetStateAction<boolean>>;\r\n\tcloseFuncCallback?: Function;\r\n\tinnerDomStyle?: CSSProperties;\r\n\tinnerConstDomStyle?: CSSProperties;\r\n\tsetState: Function;\r\n\tstate: boolean;\r\n\tunmount: Function;\r\n}\r\n\r\nexport const mount = document.body;\r\n\r\nexport function Modal(props: PropsWithChildren<ModalProps>) {\r\n\tconst {\r\n\t\tconstnode,\r\n\t\tvisible,\r\n\t\tcloseFuncCallback,\r\n\t\tinnerDomStyle,\r\n\t\tinnerConstDomStyle,\r\n\t\tstate,\r\n\t\tsetState,\r\n\t\tunmount,\r\n\t} = props;\r\n\r\n\tconst render = useMemo(() => {\r\n\t\tif (visible) {\r\n\t\t\treturn createPortal(\r\n\t\t\t\t<div\r\n\t\t\t\t\tclassName={`${\r\n\t\t\t\t\t\tstate === true ? \"yhmodalopen\" : \"yhmodalclose\"\r\n\t\t\t\t\t}`}\r\n\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t...innerDomStyle,\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\t{props.children}\r\n\t\t\t\t</div>,\r\n\t\t\t\tmount\r\n\t\t\t);\r\n\t\t} else {\r\n\t\t\tunmount();\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}, [innerDomStyle, props.children, state, unmount, visible]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (closeFuncCallback) {\r\n\t\t\tcloseFuncCallback(setState);\r\n\t\t}\r\n\t}, [closeFuncCallback, setState]);\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t{render}\r\n\t\t\t<div\r\n\t\t\t\tstyle={{ display: \"inline-block\", ...innerConstDomStyle }}\r\n\t\t\t\tonClick={() => setState(!visible)}\r\n\t\t\t>\r\n\t\t\t\t{constnode}\r\n\t\t\t</div>\r\n\t\t</>\r\n\t);\r\n}\r\n\r\nexport default Modal;\r\n","import React, {\r\n\tCSSProperties,\r\n\tPropsWithChildren,\r\n\tReactNode,\r\n\tRefObject,\r\n\tuseEffect,\r\n\tuseMemo,\r\n\tuseRef,\r\n\tuseState,\r\n} from \"react\";\r\nimport Modal from \"./minifymodal\";\r\nimport {\r\n\tPopDirections,\r\n\tswitchPosition,\r\n\tswitchTrianglePosition,\r\n} from \"./position\";\r\nimport \"./index.css\";\r\nimport { useStateAnimation } from \"./hooks\";\r\n\r\nexport interface PopoverProps {\r\n\t//这个是弹窗内容\r\n\tcontent: ReactNode;\r\n\t//这个是方向 默认top\r\n\tdirections: PopDirections;\r\n\t//回调强制刷新函数，用来重新计算位置\r\n\tcallback?: (v: Function) => void;\r\n\t//用来回调关闭函数，如果content中有需要点击关闭的，使用此回调参数\r\n\tcloseFuncCallback?: Function;\r\n\t//触发元素的壳的样式\r\n\tconstDomStyle?: CSSProperties;\r\n\t//弹窗元素的壳的样式\r\n\tmodalDomStyle?: CSSProperties;\r\n\t//小三角的元素样式\r\n\ttriangleDomStyle?: CSSProperties;\r\n\t//弹窗内层壳的样式，一般不用改\r\n\tinnerDomStyle?: CSSProperties;\r\n\t//触发元素内层壳的样式，一般不用改\r\n\tinnerConstDomStyle?: CSSProperties;\r\n\t//modal的ref回调,一般用于绑定事件\r\n\tmodalRefCallback?: (v: RefObject<HTMLDivElement>) => void;\r\n\t//要modal外关闭元素则true，否则false,default true\r\n\tneedOutsideClose?: boolean;\r\n}\r\n\r\nfunction Popover(props: PropsWithChildren<PopoverProps>) {\r\n\tconst {\r\n\t\tcontent,\r\n\t\tdirections,\r\n\t\tchildren,\r\n\t\tcallback,\r\n\t\tcloseFuncCallback,\r\n\t\tconstDomStyle,\r\n\t\tmodalDomStyle,\r\n\t\ttriangleDomStyle,\r\n\t\tinnerDomStyle,\r\n\t\tinnerConstDomStyle,\r\n\t\tmodalRefCallback,\r\n\t\tneedOutsideClose,\r\n\t} = props;\r\n\tconst [visible, setVisible] = useState(false);\r\n\tconst [style, setStyle] = useState<CSSProperties>({});\r\n\tconst [triaStyle, setTriaStyle] = useState<CSSProperties>({});\r\n\tconst [forceState, forceRender] = useState(0);\r\n\tconst modalRef = useRef<HTMLDivElement>(null);\r\n\tconst ref = useRef<HTMLDivElement>(null);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (callback) {\r\n\t\t\tcallback(() => forceRender((v) => v + 1));\r\n\t\t}\r\n\t}, [callback]);\r\n\r\n\t//这里是常驻的dom\r\n\tconst constDom = useMemo(() => {\r\n\t\treturn (\r\n\t\t\t<div\r\n\t\t\t\tstyle={{ display: \"inline-block\", ...constDomStyle }}\r\n\t\t\t\tref={ref}\r\n\t\t\t>\r\n\t\t\t\t{children}\r\n\t\t\t</div>\r\n\t\t);\r\n\t}, [children, constDomStyle]);\r\n\r\n\t//提供样式并定位\r\n\tconst finalRender = useMemo(() => {\r\n\t\treturn (\r\n\t\t\t<div\r\n\t\t\t\tstyle={{\r\n\t\t\t\t\tposition: \"absolute\",\r\n\t\t\t\t\t...style,\r\n\t\t\t\t\tboxShadow:\r\n\t\t\t\t\t\t\"0 3px 6px -4px rgba(0,0,0,.12), 0 6px 16px 0 rgba(0,0,0,.08), 0 9px 28px 8px rgba(0,0,0,.05)\",\r\n\t\t\t\t\tborderRadius: \"2px\",\r\n\t\t\t\t\tpadding: \"10px\",\r\n\t\t\t\t\tbackground: \"white\",\r\n\t\t\t\t\tzIndex: 2000,\r\n\t\t\t\t\t...modalDomStyle,\r\n\t\t\t\t}}\r\n\t\t\t\tref={modalRef}\r\n\t\t\t>\r\n\t\t\t\t{content}\r\n\t\t\t</div>\r\n\t\t);\r\n\t}, [style, modalDomStyle, content]);\r\n\r\n\t//1个render需要一个小三角\r\n\tconst triangle = useMemo(() => {\r\n\t\treturn (\r\n\t\t\t<div\r\n\t\t\t\tstyle={{\r\n\t\t\t\t\tposition: \"absolute\",\r\n\t\t\t\t\ttransform: \"rotate(45deg)\",\r\n\t\t\t\t\theight: \"8px\",\r\n\t\t\t\t\twidth: \"8px\",\r\n\t\t\t\t\tbackground: \"#fff\",\r\n\t\t\t\t\tzIndex: 2000,\r\n\t\t\t\t\tborderColor: \"transparent #fff #fff transparent\",\r\n\t\t\t\t\t...triaStyle,\r\n\t\t\t\t\t...triangleDomStyle,\r\n\t\t\t\t}}\r\n\t\t\t></div>\r\n\t\t);\r\n\t}, [triaStyle, triangleDomStyle]);\r\n\r\n\tuseEffect(() => {\r\n\t\t//出现时才有modal\r\n\t\tif (ref.current && modalRef.current) {\r\n\t\t\tconst scroll =\r\n\t\t\t\tdocument.documentElement.scrollTop + document.body.scrollTop; //移动端可能取不到\r\n\r\n\t\t\tlet res = switchPosition(\r\n\t\t\t\tdirections!,\r\n\t\t\t\tmodalRef.current.getBoundingClientRect(),\r\n\t\t\t\tref.current.getBoundingClientRect(),\r\n\t\t\t\tscroll\r\n\t\t\t);\r\n\t\t\tsetStyle(res);\r\n\t\t\t//拿到三角形的pos\r\n\t\t\tlet res2 = switchTrianglePosition(\r\n\t\t\t\tdirections!,\r\n\t\t\t\tmodalRef.current.getBoundingClientRect(),\r\n\t\t\t\tref.current.getBoundingClientRect(),\r\n\t\t\t\tscroll\r\n\t\t\t);\r\n\t\t\tsetTriaStyle(res2);\r\n\t\t}\r\n\t}, [directions, modalRef, visible, forceState]);\r\n\r\n\tuseEffect(() => {\r\n\t\tconst handler = () => {\r\n\t\t\tforceRender((prev) => prev + 1);\r\n\t\t};\r\n\t\twindow.addEventListener(\"resize\", handler);\r\n\t\treturn () => {\r\n\t\t\twindow.removeEventListener(\"resize\", handler);\r\n\t\t};\r\n\t}, [forceRender]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (modalRefCallback) {\r\n\t\t\tmodalRefCallback(modalRef);\r\n\t\t}\r\n\t}, [modalRefCallback]);\r\n\r\n\tconst [state, setState, unmount] = useStateAnimation(setVisible, 150);\r\n\r\n\tuseEffect(() => {\r\n\t\tlet listener: (event: MouseEvent) => void;\r\n\t\tif (needOutsideClose) {\r\n\t\t\tlistener = (event: MouseEvent) => {\r\n\t\t\t\tif (\r\n\t\t\t\t\t!modalRef.current ||\r\n\t\t\t\t\tmodalRef.current.contains(event.target as Node)\r\n\t\t\t\t) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tsetState(false);\r\n\t\t\t};\r\n\t\t\twindow.addEventListener(\"click\", listener);\r\n\t\t}\r\n\t\treturn () => {\r\n\t\t\twindow.removeEventListener(\"click\", listener);\r\n\t\t};\r\n\t}, [needOutsideClose, setState]);\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<Modal\r\n\t\t\t\tvisible={visible}\r\n\t\t\t\tsetVisible={setVisible}\r\n\t\t\t\tconstnode={constDom}\r\n\t\t\t\tcloseFuncCallback={closeFuncCallback}\r\n\t\t\t\tinnerDomStyle={innerDomStyle}\r\n\t\t\t\tinnerConstDomStyle={innerConstDomStyle}\r\n\t\t\t\tstate={state}\r\n\t\t\t\tsetState={setState}\r\n\t\t\t\tunmount={unmount}\r\n\t\t\t>\r\n\t\t\t\t{finalRender}\r\n\t\t\t\t{triangle}\r\n\t\t\t</Modal>\r\n\t\t</>\r\n\t);\r\n}\r\n\r\nPopover.defaultProps = {\r\n\tdirections: \"TOP\",\r\n\tneedOutsideClose: true,\r\n};\r\n\r\nexport default Popover;\r\n","import { CSSProperties } from \"react\";\r\n\r\nexport type PopDirections =\r\n\t| \"TL\"\r\n\t| \"TOP\"\r\n\t| \"TR\"\r\n\t| \"LT\"\r\n\t| \"LEFT\"\r\n\t| \"LB\"\r\n\t| \"BL\"\r\n\t| \"BOTTOM\"\r\n\t| \"BR\"\r\n\t| \"RT\"\r\n\t| \"RIGHT\"\r\n\t| \"RB\";\r\n\r\nexport function switchPosition(\r\n\tsign: PopDirections,\r\n\tmodalrect: DOMRect,\r\n\tpopconfirmrect: DOMRect,\r\n\tscroll: number\r\n): CSSProperties {\r\n\tlet triangle = 8;\r\n\tswitch (sign) {\r\n\t\tcase \"TL\":\r\n\t\t\treturn {\r\n\t\t\t\ttop: popconfirmrect.top + scroll - modalrect.height - triangle,\r\n\t\t\t\tleft: popconfirmrect.left,\r\n\t\t\t};\r\n\t\tcase \"TOP\":\r\n\t\t\treturn {\r\n\t\t\t\ttop: popconfirmrect.top + scroll - modalrect.height - triangle,\r\n\t\t\t\tleft:\r\n\t\t\t\t\tpopconfirmrect.left -\r\n\t\t\t\t\tmodalrect.width / 2 +\r\n\t\t\t\t\tpopconfirmrect.width / 2,\r\n\t\t\t};\r\n\t\tcase \"TR\":\r\n\t\t\treturn {\r\n\t\t\t\ttop: popconfirmrect.top + scroll - modalrect.height - triangle,\r\n\t\t\t\tleft:\r\n\t\t\t\t\tpopconfirmrect.left -\r\n\t\t\t\t\tmodalrect.width +\r\n\t\t\t\t\tpopconfirmrect.width,\r\n\t\t\t};\r\n\t\tcase \"LT\":\r\n\t\t\treturn {\r\n\t\t\t\ttop: popconfirmrect.top + scroll,\r\n\t\t\t\tleft: popconfirmrect.left - modalrect.width - triangle,\r\n\t\t\t};\r\n\t\tcase \"LEFT\":\r\n\t\t\treturn {\r\n\t\t\t\ttop:\r\n\t\t\t\t\tpopconfirmrect.top +\r\n\t\t\t\t\tscroll +\r\n\t\t\t\t\tpopconfirmrect.height / 2 -\r\n\t\t\t\t\tmodalrect.height / 2,\r\n\t\t\t\tleft: popconfirmrect.left - modalrect.width - triangle,\r\n\t\t\t};\r\n\t\tcase \"LB\":\r\n\t\t\treturn {\r\n\t\t\t\ttop:\r\n\t\t\t\t\tpopconfirmrect.top +\r\n\t\t\t\t\tscroll +\r\n\t\t\t\t\tpopconfirmrect.height -\r\n\t\t\t\t\tmodalrect.height,\r\n\t\t\t\tleft: popconfirmrect.left - modalrect.width - triangle,\r\n\t\t\t};\r\n\t\tcase \"BL\":\r\n\t\t\treturn {\r\n\t\t\t\ttop:\r\n\t\t\t\t\tpopconfirmrect.top +\r\n\t\t\t\t\tscroll +\r\n\t\t\t\t\tpopconfirmrect.height +\r\n\t\t\t\t\ttriangle,\r\n\t\t\t\tleft: popconfirmrect.left,\r\n\t\t\t};\r\n\t\tcase \"BOTTOM\":\r\n\t\t\treturn {\r\n\t\t\t\ttop:\r\n\t\t\t\t\tpopconfirmrect.top +\r\n\t\t\t\t\tscroll +\r\n\t\t\t\t\tpopconfirmrect.height +\r\n\t\t\t\t\ttriangle,\r\n\t\t\t\tleft:\r\n\t\t\t\t\tpopconfirmrect.left +\r\n\t\t\t\t\tpopconfirmrect.width / 2 -\r\n\t\t\t\t\tmodalrect.width / 2,\r\n\t\t\t};\r\n\t\tcase \"BR\":\r\n\t\t\treturn {\r\n\t\t\t\ttop:\r\n\t\t\t\t\tpopconfirmrect.top +\r\n\t\t\t\t\tscroll +\r\n\t\t\t\t\tpopconfirmrect.height +\r\n\t\t\t\t\ttriangle,\r\n\t\t\t\tleft:\r\n\t\t\t\t\tpopconfirmrect.left +\r\n\t\t\t\t\tpopconfirmrect.width -\r\n\t\t\t\t\tmodalrect.width,\r\n\t\t\t};\r\n\t\tcase \"RT\":\r\n\t\t\treturn {\r\n\t\t\t\ttop: popconfirmrect.top + scroll,\r\n\t\t\t\tleft: popconfirmrect.left + popconfirmrect.width + triangle,\r\n\t\t\t};\r\n\t\tcase \"RIGHT\":\r\n\t\t\treturn {\r\n\t\t\t\ttop:\r\n\t\t\t\t\tpopconfirmrect.top +\r\n\t\t\t\t\tscroll +\r\n\t\t\t\t\tpopconfirmrect.height / 2 -\r\n\t\t\t\t\tmodalrect.height / 2,\r\n\t\t\t\tleft: popconfirmrect.left + popconfirmrect.width + triangle,\r\n\t\t\t};\r\n\t\tcase \"RB\":\r\n\t\t\treturn {\r\n\t\t\t\ttop:\r\n\t\t\t\t\tpopconfirmrect.top +\r\n\t\t\t\t\tscroll +\r\n\t\t\t\t\tpopconfirmrect.height -\r\n\t\t\t\t\tmodalrect.height,\r\n\t\t\t\tleft: popconfirmrect.left + popconfirmrect.width + triangle,\r\n\t\t\t};\r\n\t\tdefault:\r\n\t\t\tconsole.error(\"you may pass error directions\" + sign);\r\n\t\t\treturn {};\r\n\t}\r\n}\r\n\r\nexport function switchTrianglePosition(\r\n\tsign: PopDirections,\r\n\tmodalrect: DOMRect,\r\n\tpopconfirmrect: DOMRect,\r\n\tscroll: number\r\n): CSSProperties {\r\n\tlet triangle = Math.sqrt(8 * 8 + 8 * 8); //这里应该是8的正方形的对角线\r\n\tswitch (sign) {\r\n\t\tcase \"TL\":\r\n\t\tcase \"TOP\":\r\n\t\tcase \"TR\":\r\n\t\t\treturn {\r\n\t\t\t\ttop: popconfirmrect.top + scroll - triangle - 1,\r\n\t\t\t\tleft: popconfirmrect.left + popconfirmrect.width / 2,\r\n\t\t\t};\r\n\t\tcase \"LT\":\r\n\t\tcase \"LEFT\":\r\n\t\tcase \"LB\":\r\n\t\t\treturn {\r\n\t\t\t\ttop: popconfirmrect.top + scroll + popconfirmrect.height / 2,\r\n\t\t\t\tleft: popconfirmrect.left - triangle - 1,\r\n\t\t\t};\r\n\r\n\t\tcase \"BL\":\r\n\t\tcase \"BOTTOM\":\r\n\t\tcase \"BR\":\r\n\t\t\treturn {\r\n\t\t\t\ttop:\r\n\t\t\t\t\tpopconfirmrect.top +\r\n\t\t\t\t\tscroll +\r\n\t\t\t\t\tpopconfirmrect.height +\r\n\t\t\t\t\ttriangle / 2 -\r\n\t\t\t\t\t1,\r\n\t\t\t\tleft: popconfirmrect.left + popconfirmrect.width / 2,\r\n\t\t\t};\r\n\r\n\t\tcase \"RT\":\r\n\t\tcase \"RIGHT\":\r\n\t\tcase \"RB\":\r\n\t\t\treturn {\r\n\t\t\t\ttop: popconfirmrect.top + scroll + popconfirmrect.height / 2,\r\n\t\t\t\tleft: popconfirmrect.left + popconfirmrect.width + triangle / 2,\r\n\t\t\t};\r\n\t\tdefault:\r\n\t\t\tconsole.error(\"you may pass error directions\" + sign);\r\n\t\t\treturn {};\r\n\t}\r\n}\r\n","import { useMemo, useState } from \"react\";\r\n\r\nexport function useStateAnimation(\r\n\tparentSetState: (v: boolean) => void,\r\n\tdelay: number = 300\r\n): [boolean, (v: boolean) => void, () => void] {\r\n\tconst [state, setState] = useState(true);\r\n\tconst [innerClose, unmount] = useMemo(() => {\r\n\t\tlet timer: number;\r\n\t\tlet innerclose = (v: boolean) => {\r\n\t\t\tsetState(v);\r\n\t\t\ttimer = window.setTimeout(() => {\r\n\t\t\t\tparentSetState(v);\r\n\t\t\t\tsetState(true);\r\n\t\t\t}, delay);\r\n\t\t};\r\n\t\tlet unmount = () => window.clearTimeout(timer);\r\n\t\treturn [innerclose, unmount];\r\n\t}, [setState, parentSetState, delay]);\r\n\treturn [state, innerClose, unmount];\r\n}\r\n","import React from \"react\";\nimport \"./App.css\";\nimport Popover from \"./components/index\";\n\nfunction App() {\n\treturn (\n\t\t<div>\n\t\t\t<div style={{ height: \"200px\" }}></div>\n\t\t\t<div\n\t\t\t\tstyle={{\n\t\t\t\t\tdisplay: \"flex\",\n\t\t\t\t\tjustifyContent: \"center\",\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<div\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\tdisplay: \"flex\",\n\t\t\t\t\t\talignItems: \"center\",\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<Popover\n\t\t\t\t\t\t\t\tdirections=\"LT\"\n\t\t\t\t\t\t\t\tcontent={\n\t\t\t\t\t\t\t\t\t<div style={{ height: \"200px\" }}>\n\t\t\t\t\t\t\t\t\t\tLTcontent\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<button>LT</button>\n\t\t\t\t\t\t\t</Popover>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<Popover\n\t\t\t\t\t\t\t\tdirections=\"LEFT\"\n\t\t\t\t\t\t\t\tcontent={\n\t\t\t\t\t\t\t\t\t<div style={{ height: \"200px\" }}>\n\t\t\t\t\t\t\t\t\t\tLEFTcontent\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<button>LEFT</button>\n\t\t\t\t\t\t\t</Popover>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<Popover\n\t\t\t\t\t\t\t\tdirections=\"LB\"\n\t\t\t\t\t\t\t\tcontent={\n\t\t\t\t\t\t\t\t\t<div style={{ height: \"200px\" }}>\n\t\t\t\t\t\t\t\t\t\tLBcontent\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<button>LB</button>\n\t\t\t\t\t\t\t</Popover>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\theight: \"150px\",\n\t\t\t\t\t\t\t\twidth: \"150px\",\n\t\t\t\t\t\t\t\tdisplay: \"flex\",\n\t\t\t\t\t\t\t\tjustifyContent: \"center\",\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Popover\n\t\t\t\t\t\t\t\tdirections=\"TL\"\n\t\t\t\t\t\t\t\tcontent={<div>TLcontent</div>}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<button>TL</button>\n\t\t\t\t\t\t\t</Popover>\n\t\t\t\t\t\t\t<Popover\n\t\t\t\t\t\t\t\ttriangleDomStyle={{ background: \"blue\" }}\n\t\t\t\t\t\t\t\tmodalDomStyle={{\n\t\t\t\t\t\t\t\t\tbackground: \"blue\",\n\t\t\t\t\t\t\t\t\tcolor: \"white\",\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\tcontent={<div>TOPcontent</div>}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<button>TOP</button>\n\t\t\t\t\t\t\t</Popover>\n\t\t\t\t\t\t\t<Popover\n\t\t\t\t\t\t\t\tdirections=\"TR\"\n\t\t\t\t\t\t\t\tcontent={<div>TRcontent</div>}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<button>TR</button>\n\t\t\t\t\t\t\t</Popover>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<Popover\n\t\t\t\t\t\t\t\tdirections=\"BL\"\n\t\t\t\t\t\t\t\tcontent={<div>BLcontent</div>}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<button>BL</button>\n\t\t\t\t\t\t\t</Popover>\n\t\t\t\t\t\t\t<Popover\n\t\t\t\t\t\t\t\tdirections=\"BOTTOM\"\n\t\t\t\t\t\t\t\tcontent={<div>BOTTOMcontent</div>}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<button>BOTTOM</button>\n\t\t\t\t\t\t\t</Popover>\n\t\t\t\t\t\t\t<Popover\n\t\t\t\t\t\t\t\tdirections=\"BR\"\n\t\t\t\t\t\t\t\tcontent={<div>BRcontent</div>}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<button>BR</button>\n\t\t\t\t\t\t\t</Popover>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<Popover\n\t\t\t\t\t\t\t\tdirections=\"RT\"\n\t\t\t\t\t\t\t\tneedOutsideClose={false} //组件外不关闭\n\t\t\t\t\t\t\t\tcontent={<div>RTcontent</div>}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<button>RT</button>\n\t\t\t\t\t\t\t</Popover>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<Popover\n\t\t\t\t\t\t\t\tdirections=\"RIGHT\"\n\t\t\t\t\t\t\t\tcontent={<div>RIGHTcontent</div>}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<button>RIGHT</button>\n\t\t\t\t\t\t\t</Popover>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<Popover\n\t\t\t\t\t\t\t\tdirections=\"RB\"\n\t\t\t\t\t\t\t\tcontent={<div>RBcontent</div>}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<button>RB</button>\n\t\t\t\t\t\t\t</Popover>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div style={{ height: \"1200px\" }}></div>\n\t\t</div>\n\t);\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}